<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MallOrderDAO">
    <resultMap type="MemberOrderVO" id="MemberOrder">
        <id property="seq" column="SEQ" />
        <result property="id" column="ID"/>
        <result property="pwd" column="PWD"/>
        <result property="name" column="NAME"/>
        <result property="phone" column="PHONE" />
        <result property="email" column="EMAIL" />
        <result property="zipcode" column="ZIPCODE" />
        <result property="address" column="ADDRESS" />
        <result property="point" column="POINT" />
        <result property="rank" column="RANK" />
        <result property="type" column="TYPE" />
        <result property="regDate" column="REGDATE"/>
        <result property="code" column="CODE"/>
    </resultMap>

    <resultMap type="OrderVO" id="order_li">
        <id property="order_no" column="ORDER_NO" />
        <result property="order_id" column="ORDER_ID" />
        <result property="order_date" column="ORDER_DATE" />
        <result property="order_state" column="ORDER_STATE" />
        <result property="order_phone" column="ORDER_PHONE" />
        <result property="order_price" column="ORDER_PRICE" />
        <result property="order_address" column="ORDER_ADDRESS" />
        <result property="order_receiver" column="ORDER_RECEIVER" />
        <result property="order_memo" column="ORDER_MEMO" />
        <result property="order_zipcode" column="ORDER_ZIPCODE" />
        <result property="order_point_used" column="ORDER_POINT_USED" />
        <result property="order_name" column="ORDER_NAME" />
        <result property="order_quantity" column="ORDER_QUANTITY" />
    </resultMap>

    <resultMap type="CartListVO" id="CartList">
        <result property="cartList_name" column="CARTLIST_NAME" />
        <result property="cartList_price" column="CARTLIST_PRICE" />
        <result property="cartList_discount" column="CARTLIST_DISCOUNT" />
        <result property="cartList_stock" column="CARTLIST_STOCK" />
        <result property="cartList_point" column="CARTLIST_POINT" />
        <result property="cartList_info" column="CARTLIST_INFO" />
        <result property="cartList_img" column="CARTLIST_IMG" />
    </resultMap>


<!--    <insert id="insertMallOrder" parameterType="mallOrder">-->
<!--        INSERT INTO order (toy_code, toy_name, toy_inStock, toy_price,-->
<!--            toy_discount, toy_stock, toy_point, toy_info, toy_img)-->
<!--        VALUES(toy_seq.nextval, #{toy_name}, sysdate, #{toy_price},-->
<!--            #{toy_discount}, #{toy_stock}, #{toy_point}, #{toy_info}, #{toy_img})-->
<!--    </insert>-->
<!--    결제 완료된 feed order 테이블 두개에 넣어주기-->
    <insert id="insertOrderFeed" parameterType="OrderVO">
        INSERT INTO order_list (order_no, order_id, order_phone, order_price, order_state,
                                    order_memo, order_address, order_receiver, order_zipcode,
                                        order_point_used, order_name, order_quantity)
        VALUES(order_no_seq.NEXTVAL, #{order_id}, #{order_phone}, #{order_price}, '배송중',
                    '배송 잘 해 주세요', #{order_address}, #{order_receiver}, #{order_zipcode},
                        #{order_point_used}, #{order_name}, #{order_quantity})
    </insert>


    <!-- 주문목록 불러오기 -->
    <select id="getOrderList" resultType="OrderVO">
        SELECT * FROM order_list order by order_no asc
    </select>

    <!--    주문목록 삭제하기-->
    <delete id="deleteOrder" parameterType="OrderVO">
        DELETE FROM order_list WHERE order_no=#{order_no}
    </delete>

    <!--    주문상태 수정(배송처리)-->
    <update id="updateState" parameterType="OrderVO">
        UPDATE order_list set order_state='발송처리' where order_no=#{order_no}
    </update>

    <!--    주문상태 수정(배송완료)-->
    <update id="stateSuccess" parameterType="OrderVO">
        UPDATE order_list set order_state='배송완료' where order_no=#{order_no}
    </update>

    <!-- 포인트적립 불러오기  -->
    <select id="getMallPointList" resultType="mallOrderVO">
        SELECT * FROM order_status
    </select>
    <!--#######  CARTLIST 관련 쿼리문  #########################################################################-->
    <!-- 장바구니 담기 누를시 장바구니 테이블에 값 넣어주기 -->
    <insert id="insertCartList" parameterType="CartListVO">
        insert into cartlist (cartlist_code,cartlist_name, cartlist_price, cartlist_discount,
            cartlist_stock, cartlist_point, cartlist_info, cartlist_img)
            VALUES(#{cartList_code},#{cartList_name},#{cartList_price},#{cartList_discount},#{cartList_stock},
                #{cartList_point},#{cartList_info},#{cartList_img})
    </insert>
    <!--  장바구니 테이블에담긴 물품들 가져오기  -->
    <select id="selectCartList" resultType="CartListVO">
        select * from cartlist
    </select>
    <!--  장바구니에 담긴거 삭제하기  -->
    <delete id="deleteCartListOne" parameterType="CartListVO">
        delete from cartlist where cartlist_code=#{cartList_code}
    </delete>
<!--    #################################################################################################-->

<!--    회원 결제시 포인트 삭제-->
    <update id="updateMemberPoint" parameterType="MemberOrderVO">
        UPDATE member SET point=#{point} WHERE id=#{id}
    </update>


</mapper>






